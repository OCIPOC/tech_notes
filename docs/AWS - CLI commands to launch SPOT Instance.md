
# Spot Instance CLI command reference

> place the spot request 
``` bash
aws ec2 request-spot-instances --block-duration-minutes 60  --instance-count 1  --launch-specification     "{ \
       \"ImageId\":\"ami-026dea5602e368e96\", \
       \"InstanceType\":\"m4.large\", \
       \"KeyName\":\"RSS-ISH\", \
       \"SecurityGroups\": [\"ServerTest-001\"] ,\
	   \"UserData\":\"IyEvYmluL2Jhc2ggLXhlCmV4ZWMgPiA+KHRlZSAvdmFyL2xvZy91c2VyLWRhdGEubG9nfGxvZ2dlciAtdCB1c2VyLWRhdGEgLXMgMj4vZGV2L2NvbnNvbGUpIDI+JjEKd2hvYW1pCnN1ZG8gbXYgL2V0Yy9sb2NhbHRpbWUgL2V0Yy9sb2NhbHRpbWUub3JpZ2luYWwKc3VkbyBsbiAtcyAvdXNyL3NoYXJlL3pvbmVpbmZvL0FtZXJpY2EvTmV3X1lvcmsgL2V0Yy9sb2NhbHRpbWUKeXVtIC15IHVwZGF0ZQplY2hvIHVybD0iaHR0cHM6Ly93d3cuZHVja2Rucy5vcmcvdXBkYXRlP2RvbWFpbnM9bWMtZXcmdG9rZW49NzNkNjU4MWItZmUyZi00ZDljLWI1YWMtMDExOTk0MDk3NDUwJmlwPSIgfCBjdXJsIC1LIC0KI2VjaG8gdXJsPSJodHRwczovL3d3dy5kdWNrZG5zLm9yZy91cGRhdGU/ZG9tYWlucz1tYy1mdHAmdG9rZW49NzNkNjU4MWItZmUyZi00ZDljLWI1YWMtMDExOTk0MDk3NDUwJmlwPSIgfCBjdXJsIC1LIC0Kc3VkbyB5dW0gdXBkYXRlIC15CnN1ZG8geXVtIGluc3RhbGwgaHRvcCAteQpzdWRvIHl1bSBpbnN0YWxsIHNjcmVlbiAteQpzdWRvIHl1bSBpbnN0YWxsIHN5c3N0YXQgLXkKI3N1ZG8geXVtIGluc3RhbGwgd2dldCAteQojc3VkbyB5dW0gaW5zdGFsbCBwaWd6IC15CiNzdWRvIHl1bSBpbnN0YWxsIG5tYXAtbmNhdCAteQojc3VkbyBhbWF6b24tbGludXgtZXh0cmFzIGluc3RhbGwgZXBlbAojc3VkbyB5dW0gaW5zdGFsbCBmYWlsMmJhbiAteQojc3VkbyB5dW0gaW5zdGFsbCBzM2NtZCAteQojc3VkbyB5dW0gaW5zdGFsbCBpcGVyZjMgLXkKc3VkbyBzdSAtIGVjMi11c2VyIDw8IFxERUZLRVkKCSNta2RpciAtcCB+Ly5zc2ggfHRlZSAtYSAvdG1wL3VzZXJfaW5pdC5sb2cKCXRvdWNoIC5zc2gvcmF2aWZ0cC5wZW0gfHRlZSAtYSAvdG1wL3VzZXJfaW5pdC5sb2cKCWNobW9kIDYwMCAuc3NoL3JhdmlmdHAucGVtIHx0ZWUgLWEgL3RtcC91c2VyX2luaXQubG9nCgljYXQgPDxFT0YgPn4vLnNzaC9yYXZpZnRwLnBlbSB8dGVlIC1hIC90bXAvdXNlcl9pbml0LmxvZwotLS0tLUJFR0lOIE9QRU5TU0ggUFJJVkFURSBLRVktLS0tLQpiM0JsYm5OemFDMXJaWGt0ZGpFQUFBQUFCRzV2Ym1VQUFBQUVibTl1WlFBQUFBQUFBQUFCQUFBQkZ3QUFBQWR6YzJndGNuCk5oQUFBQUF3RUFBUUFBQVFFQXBsMFB2ZVpTL20zUVdScUJRdFhGb21zejhTVVJ2STlrKzc5Rnh4T2lkSjhBNlk2em5DOUMKQUZGZ0hzbVBlSjdWMXdGenlxc3hRS0czU3Y1ZmhySVgyT2Z5cnpFUmpxcDZFbnFOSDg3SEJXRU5aOXNBcnBrV2tmMWtkagpwU09oMGJLMGYxWjBDTFduazkyeTRZaDBta0pDRzJMZzE2SkxnYVhUSmtkUlpBa1ducmp4WVdEd2RuRG9NSzJBTUlSYnVWCk1YTEM2STdwQ3Y5VmZEVjZsWXdOUUdrSWM0RUpOaDVJdExwMHhtUmVodThVWElvbVY4OXRHdWxYeDVWQ2FEcGFWdXdaLzIKbFl6ZlRqV2lsS1FaLzQyanIxNEhVMmFKM2xJZFBMdURPMU5EdGdIbHV3amZIbHlBVEpZMm1ubGE0RFhsU1RpSjFlR2ViMgp2MUpQamVlSWR3QUFBOUE2UWlYc09rSWw3QUFBQUFkemMyZ3Rjbk5oQUFBQkFRQ21YUSs5NWxMK2JkQlpHb0ZDMWNXaWF6ClB4SlJHOGoyVDd2MFhIRTZKMG53RHBqck9jTDBJQVVXQWV5WTk0bnRYWEFYUEtxekZBb2JkSy9sK0dzaGZZNS9Ldk1SR08KcW5vU2VvMGZ6c2NGWVExbjJ3Q3VtUmFSL1dSMk9sSTZIUnNyUi9WblFJdGFlVDNiTGhpSFNhUWtJYll1RFhva3VCcGRNbQpSMUZrQ1JhZXVQRmhZUEIyY09nd3JZQXdoRnU1VXhjc0xvanVrSy8xVjhOWHFWakExQWFRaHpnUWsySGtpMHVuVEdaRjZHCjd4UmNpaVpYejIwYTZWZkhsVUpvT2xwVzdCbi9hVmpOOU9OYUtVcEJuL2phT3ZYZ2RUWm9uZVVoMDh1NE03VTBPMkFlVzcKQ044ZVhJQk1samFhZVZyZ05lVkpPSW5WNFo1dmEvVWsrTjU0aDNBQUFBQXdFQUFRQUFBUUVBaGFVdENEa0hZeTJFdW8vNApWMkMwTEE1QzQrNExtWmI0WU9UL2dUWGN4Q01YOElpYThWVmxpQ3ZYTStSb1JWWVVJMjBmUUNqV29EMUpxZzAvWUUyaHFyClpxMXlKc0lGZ0RTT1Q2aWhycTl2OUliYTRabGltVllDSlhta0t2MjgrV0MrYjYxYitjTTBwQ3p0anhDMzIxUnZGdUVRRHkKcHB6ZlVROHlkSDB6MFp3aHVHTmtldWl3OUpqR2VNaWEyUTRsT0pyd1Z4OUE2Wm5HWURlOFlwbFMySHUzRWJNb0k1TWkxKworZ2V3SXlqRWJaaUs5cllKZlZpRDlHdm12ZG1VbDQyM2VINDFYaXF0Qno3cnN4YXhXWXFoM1pmRDdrb09sZmxpV3lTKzRtCmlkYXlwdTVveUxPM0ZSUXlQRWYwcjBCQjNFczZkbTdDWHlFdy9VR2RWd3cwUVFBQUFJRUF3UTZMVVJwUWQ0QitBbEF3QXEKTFE2RjJqMVRYbmw5Y0JRanl0TkFHZWRLTGh4T1RueW85U3I1QWd3K09Sbnl4eHQvK1k3U0xsNWNxanFRcWFxay8vOW9PNwpPSXdiclJDdGR4NWtzaE52UENtbTNJU0ZaVFp6WTg2NElHQmhybzBMY2RRSU1Pa3Y2cVhNUHZ4Y1FTS1VhaVZWNU9FWWpyCnZIeGxTK3NFd082cW9BQUFDQkFOWlJkaGU1QUowN0s2VFM1b1hIdU8xNlNBeE96NWxzZ041ditOUWp0TWsyK1U4RUpNZWYKZE9hQzljS0x5aC9tZ0Nkd1AweFUxWHM2V2w3aGFnVGdtWVc1QjU0VzNGaSt0L2NkZlNRSjE2RUREZHJUOWpXaTlzMTF4WgpMMXhYc0graVNZcDJ4VU5MK01SN08zWXJvT25iMmRHZnFCZ296eXlReXE1QXZ0UVBBckFBQUFnUURHdUFTYWtPOUdLYWJiCkk4N1BIZXhCMThPZndaOGtBaHArRkRoM0s0VmszQXdhbnBMd3dzSVh1YUl3cEFJVWkyRzF6ZDQ1TXhSeDIzcG1MaFVDVEoKVXdaWHhmSmNCSHE3ZUtrRHZPUmhCS0pqQmxCcks4VHl4bVhteTFFMWNSMzJieGk5aGQ4Vk1JRlFSdUtyYVlUVVh5NmpSaApQTDNobmlJVGVoQTdCd2NXNVFBQUFCVlRZWGxoYkhKaGRrQkhNRFZWVTFoT01EQXlNemNCQWdNRQotLS0tLUVORCBPUEVOU1NIIFBSSVZBVEUgS0VZLS0tLS0KRU9GCglyc3luYyAtYXYgLS1leGNsdWRlPSIuc3NoIiAtZSAic3NoIC1pIH4vLnNzaC9yYXZpZnRwLnBlbSAtbyBTdHJpY3RIb3N0S2V5Q2hlY2tpbmc9bm8iIHJhdmlmdHBAbWMtZnRwLmR1Y2tkbnMub3JnOi9ob21lL3JhdmlmdHAvamRrLTh1MjUxLWxpbnV4LXg2NC5ycG0gL2hvbWUvZWMyLXVzZXIvbWMvICB8dGVlIC1hIC90bXAvdXNlcl9pbml0LmxvZwoJcnN5bmMgLWF2IC0tZXhjbHVkZT0iLnNzaCIgLWUgInNzaCAtaSB+Ly5zc2gvcmF2aWZ0cC5wZW0gLW8gU3RyaWN0SG9zdEtleUNoZWNraW5nPW5vIiByYXZpZnRwQG1jLWZ0cC5kdWNrZG5zLm9yZzovaG9tZS9yYXZpZnRwL2xhdGVzdC8gL2hvbWUvZWMyLXVzZXIvbWMvICB8dGVlIC1hIC90bXAvdXNlcl9pbml0LmxvZwoJY3AgL2hvbWUvZWMyLXVzZXIvbWMvLnNjcmVlbnJjIC9ob21lL2VjMi11c2VyLwoJY3AgL2hvbWUvZWMyLXVzZXIvbWMvZnVuYy5zaCAvaG9tZS9lYzItdXNlci8KCWNkIG1jCglzdWRvIHJwbSAtaSBqZGstKmxpbnV4LXg2NC5ycG0gfHRlZSAtYSAvdG1wL3VzZXJfaW5pdC5sb2cKCWZpbmQgLiAtbmFtZSAicnVuLmJhdCIgLWV4ZWMgY2htb2QgNzc3IHt9IFw7IHx0ZWUgLWEgL3RtcC91c2VyX2luaXQubG9nCgkjIyBVcGRhdGUgQnVuZ2VlY29yZC9jb25maWcueW1sCglORVdJUD1gaG9zdG5hbWUgLUkgfCBhd2sgJ3twcmludCAkMX0nYAoJTkVXSVA9JChob3N0bmFtZSAtSSB8IGF3ayAne3ByaW50ICQxfScpCglzZWQgIC1pIC1yICJzLyhcYlswLTldezEsM31cLil7M31bMC05XXsxLDN9XGIvJE5FV0lQL2ciIEJ1bmdlZWNvcmQvY29uZmlnLnltbCB8dGVlIC1hIC90bXAvdXNlcl9pbml0LmxvZwoJYXQgJChkYXRlICAtZCAiJChkYXRlKSArMTEyIG1pbiIgIislSDolTSIpIDw8RU9GSk9CCmVjaG8gKioqKioqKjsgZWNobyBzdGFydGVkIGJhY2t1cCBhdCBgZGF0ZSAtciAvZGV2L251bGwgKyIlWV8lbV8lZF8lSF8lTSJgIDE+Pi90bXAvYXQubG9nIDI+Pi90bXAvYXQubG9nIDsgc291cmNlIH4vZnVuYy5zaCAxPj4vdG1wL2F0LmxvZyAyPj4vdG1wL2F0LmxvZyA7IGJhY2t1cCAxPj4vdG1wL2F0LmxvZyAyPj4vdG1wL2F0LmxvZyAKRU9GSk9CCkRFRktFWQ==\" \
   }" 
```

> Check the spot request status
``` bash
aws ec2 describe-spot-instance-requests \
    --query "SpotInstanceRequests[*].[CreateTime,SpotInstanceRequestId,Status.Code, LaunchedAvailabilityZone, InstanceType, InstanceId]" \
    --output table
``` bash

> Pull the IP Address of the Spot Instances
``` bash
aws ec2 describe-spot-instance-requests \
    --query "SpotInstanceRequests[*].[CreateTime,SpotInstanceRequestId,Status.Code, LaunchedAvailabilityZone, InstanceType, InstanceId]" \
    --output table	| \
  grep "fulfilled" | \
  cut -d'|' -f7  | \
xargs echo | \
xargs -t -I {} aws ec2 describe-instances --instance-ids={} --query "Reservations[].Instances[][PublicIpAddress,InstanceId,LaunchTime]" \
    --output table
```

> ssh connection command
``` bash
ssh -i ./RSS-ISH.pem ec2-user@18.1.2.23 -o StrictHostKeyChecking=no 	
ssh -i ./RSS-ISH.pem ec2-user@mc-ew.duckdns.org -o StrictHostKeyChecking=no 	
```
